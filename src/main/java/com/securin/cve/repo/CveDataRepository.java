package com.securin.cve.repo;

import com.securin.cve.entity.CveData;
import org.springframework.data.domain.Pageable;
import org.springframework.data.mongodb.repository.MongoRepository;
import org.springframework.data.mongodb.repository.Query;

import java.time.LocalDateTime;
import java.util.List;

public interface CveDataRepository extends MongoRepository<CveData, String> {

    CveData findTopByOrderByLastModifiedDesc();

    @Query("{ 'metrics.cvssMetricV2' : { $elemMatch: { 'cvssData.baseScore' : ?0 } } }")
    List<CveData> findByBaseScore(Double score, Pageable pageable);

    List<CveData> findAllByLastModifiedAfter(LocalDateTime localDateTime, Pageable pageable);

}
