package com.securin.cve.client;

import com.securin.cve.model.NvdClientResponse;
import org.springframework.cloud.openfeign.FeignClient;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;

@FeignClient(name = "nvdClient1", url = "${cve.nvd-api.base-url}")
public interface NvdClient {

    @GetMapping("${cve.nvd-api.get-path}")
    ResponseEntity<NvdClientResponse> getCveDataByResultsPerPageAndStartIndex(@RequestParam("resultsPerPage") Long resultsPerPage, @RequestParam("startIndex") Long startIndex);

    @GetMapping("${cve.nvd-api.get-path}")
    ResponseEntity<NvdClientResponse> getCveDataByLastModStartAndEndDateAndResultsPerPageAndStartIndex(
            @RequestParam("lastModStartDate") String lastModStartDate,
            @RequestParam("lastModEndDate") String lastModEndDate,
            @RequestParam("resultsPerPage") Long resultsPerPage,
            @RequestParam("startIndex") Long startIndex);

    @GetMapping("/rest/json/cves/2.0")
    ResponseEntity<NvdClientResponse> getCveDataByCveId(@RequestParam("cveId") String lastModStartDate);


}
